!function(e){function t(t){for(var r,i,u=t[0],a=t[1],f=t[2],l=0,s=[];l<u.length;l++)i=u[l],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&s.push(o[i][0]),o[i]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(p&&p(t);s.length;)s.shift()();return c.push.apply(c,f||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,u=1;u<n.length;u++){var a=n[u];0!==o[a]&&(r=!1)}r&&(c.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={1:0},c=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var u=window.webpackJsonp=window.webpackJsonp||[],a=u.push.bind(u);u.push=t,u=u.slice();for(var f=0;f<u.length;f++)t(u[f]);var p=a;c.push([184,0]),n()}({184:function(e,t,n){"use strict";n.r(t);var r,o=n(7),c=n(98),i=n.n(c),u=n(77),a=n.n(u),f=n(42),p=n(57),l=n(6),s=n(129),d=n(73),m=n(20),b=n(53),O=n(12),g=n(8),j=n(130),v=n(16),h=n(70),y=n(58),E=n(109),_=n(4),P=function(e){var t=e.stats;return _.createElement(_.Fragment,null,"Simple TodoÂ ",Object(l.pipe)(t,g.fold((function(){return null}),(function(e){var t=e.done,n=e.total;return _.createElement("span",{className:"text-muted small"},t," / ",n)}))))},N=function(){return _.createElement("li",{className:"list-group-item"},_.createElement("em",null,"Task list is empty."))},T=function(){return _.createElement("li",{className:"list-group-item"},_.createElement("em",null,"Loading Tasks..."))},w=n(32),x=n(10),A=n(126),S=n(82),C=n(43),D=n(19),k=n(18),F=n(127),L=n(52),U=n(110),R=n(89),M=x.interface({_id:x.string,text:x.string,isDone:x.boolean,isFav:Object(A.withFallback)(x.boolean,!1)},"Todo"),I=function(e){return x.intersection([x.interface({_rev:x.string}),e])},q=x.interface({ok:x.boolean,id:x.string,rev:x.string},"Response"),B=Object(O.Union)({Add:Object(O.of)(),Change:Object(O.of)(),Load:Object(O.of)(),Remove:Object(O.of)(),Update:Object(O.of)()}),J=o.http.send(o.http.get("/todos/_all_docs?include_docs=true",(r=M,x.interface({total_rows:x.Int,offset:x.Int,rows:x.array(x.interface({id:x.string,key:x.string,doc:I(r),value:x.interface({rev:x.string})}))},"AllDocsResponse"))),B.Load),z=function(e){return o.http.send(o.http.del("/todos/".concat(e._id,"?_rev=").concat(e._rev),q),(function(t){return B.Remove(e,t)}))},G=function(e){return o.http.send(o.http.put("/todos/".concat(e._id,"?rev=").concat(e._rev),I(M).encode(e),q),(function(t){return B.Update(e,t)}))},H=function(e){var t=e.value,n=e.onChange,r=e.onSubmit;return _.createElement("form",{onSubmit:function(e){r(),e.preventDefault()}},_.createElement("div",{className:"input-group"},_.createElement("input",{type:"text",className:"form-control",name:"task",value:t,onChange:function(e){return n(e.target.value)}}),_.createElement("div",{className:"input-group-append"},_.createElement("button",{type:"submit",className:"btn btn-primary",disabled:""===t},"Add"))))},K=function(e){return 16807*e%2147483647},Q=n(128),V=n.n(Q),W=w.a.fromProp()("seed"),X=w.a.fromProp()("todo"),Y=X.composeLens(w.a.fromProp()("text")),Z=Object(O.Union)({Add:Object(O.of)(),Api:Object(O.of)(),UpdateText:Object(O.of)()}),$=function(e){return{_id:V.a.v1({msecs:e}),text:"",isDone:!1,isFav:!1}},ee=function(e){var t=function(e){var t=e%2147483647;return t<=0?t+2147483646:t}(e.seed);return[{seed:t,todo:$(t)},o.cmdr.none]},te=function(e,t){return Z.match(e,{Add:function(){return[Object(l.pipe)(t,W.modify(K),X.set($(t.seed))),Object(l.pipe)((e=t.todo,o.http.send(o.http.put("/todos/".concat(e._id),M.encode(e),q),(function(t){return B.Add(e,t)}))),o.cmdr.map(Z.Api))];var e},UpdateText:function(e){var n=e.text;return[Object(l.pipe)(t,Y.set(n)),o.cmdr.none]},default:function(){return[t,o.cmdr.none]}})},ne=n(22),re=n(47),oe=n(48),ce=n(108),ie=function(e){var t=e.isFav,n=e.isDone,r=e.text,o=e.onEdit,c=e.onToggleFav,i=e.onToggleDone,u=e.onRemove;return _.createElement("li",{className:"task-container list-group-item d-flex justify-content-between align-items-center"},_.createElement("div",null,_.createElement("a",{href:"#",className:"btn-left",onClick:c},_.createElement(re.a,{icon:t?oe.d:ce.b})),_.createElement("a",{href:"#",className:"btn-left",onClick:i},_.createElement(re.a,{icon:n?oe.a:ce.a})),n?_.createElement("del",{className:"text-muted"},r):r),_.createElement("div",null,_.createElement("a",{href:"#",className:"btn-right",onClick:o},_.createElement(re.a,{icon:oe.b})),_.createElement("a",{href:"#",className:"btn-right",onClick:u},_.createElement(re.a,{icon:oe.e}))))},ue=function(e){var t=e.text,n=e.onChange,r=e.onSave,o=e.onCancel;return _.createElement("li",{className:"task-container list-group-item"},_.createElement("form",{onSubmit:function(e){r(),e.preventDefault()}},_.createElement("div",{className:"input-group"},_.createElement("input",{className:"form-control",type:"text",value:t,onChange:n}),_.createElement("div",{className:"input-group-append"},_.createElement("button",{className:"btn btn-success",type:"submit",disabled:0===t.length},_.createElement(re.a,{icon:oe.c})),_.createElement("button",{className:"btn btn-danger",type:"button",onClick:o},_.createElement(re.a,{icon:oe.e}))))))};function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(n,!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pe=Object(O.Union)({Editing:Object(O.of)(),None:Object(O.of)()}),le=new w.a((function(e){return pe.match(e,{Editing:function(e){return e},None:function(e){return e}})}),(function(e){return function(t){return pe.match(t,{Editing:function(t,n){return pe.Editing(e,n)},None:function(){return pe.None(e)}})}})),se=le.composeLens(w.a.fromProp()("isDone")),de=le.composeLens(w.a.fromProp()("isFav")),me=le.composeLens(w.a.fromProp()("_id")),be=le.composeLens(w.a.fromProp()("_rev")),Oe=le.composeLens(w.a.fromProp()("text")),ge=new w.b((function(e){return pe.match(e,{Editing:function(e,t){return g.some(t)},default:function(){return g.none}})}),(function(e){return function(t){return pe.match(t,{Editing:function(t){return pe.Editing(t,e)},default:function(){return t}})}})),je=Object(O.Union)({Api:Object(O.of)(),Cancel:Object(O.of)(),Edit:Object(O.of)(),Save:Object(O.of)(),ToggleDone:Object(O.of)(),ToggleFav:Object(O.of)(),Remove:Object(O.of)(),UpdateText:Object(O.of)()});function ve(e){return o.stater.of(pe.None(e))}function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ye=Object(f.contramap)((function(e){return e.toLocaleLowerCase()}))(f.ordString),Ee=Object(f.contramap)(Oe.get)(ye),_e=Object(f.contramap)(se.get)(f.ordBoolean),Pe=Object(f.getSemigroup)().concat(_e,Ee),Ne=b.sort(Object(f.contramap)((function(e){var t=a()(e,2);t[0];return t[1]}))(Pe)),Te=d.Lens.fromProp()("current"),we=d.Lens.fromProp()("todos"),xe=we.composePrism(d.Prism.some()),Ae=function(e){return xe.composeLens(Object(s.atRecord)().at(e)).composePrism(d.Prism.some())},Se=function(e,t){return function(n){return Object(l.pipe)(t,xe.modify(p.insertAt(e,n)))}},Ce=Object(O.Union)({Api:Object(O.of)(),Todo:Object(O.of)(),TodoForm:Object(O.of)()}),De=o.cmdr.getMonoid(),ke=o.stater.getApplicative();var Fe=Object(l.pipe)((function(){return function(e){var t=new S.a("now"),n=Object(l.pipe)(Object(F.fromFetch)("/todos/_changes?feed=longpoll&include_docs=true&since=".concat(t.value)),L.a((function(e){return e.json()})),U.a((function(e){return t.next(e.last_seq)})),L.a((function(e){return Object(C.a)(Object(D.a)(e.results.map((function(e){return B.Change(function(e){return x.interface({changes:x.array(x.interface({rev:x.string})),doc:x.union([x.interface({_id:x.string,_rev:x.string,_deleted:x.literal(!0)}),I(e)]),id:x.string,seq:x.Int})}(M).decode(e))}))),n)})));return Object(l.pipe)(e,R.a(),L.a((function(e){return e?n:Object(k.b)()})))}}),E.map(E.local(v.a((function(e){return g.isSome(e.todos)})))),o.subr.map(Ce.Api)),Le=o.html.programR((function(e){return Object(l.pipe)(ee(e),y.bimap((function(e){return Object(h.fold)(De)([Object(l.pipe)(e,o.cmdr.map(Ce.TodoForm)),Object(l.pipe)(J,o.cmdr.map(Ce.Api))])}),(function(e){return{current:e,todos:g.none}})))}),(function(e,t){return Ce.match(e,{Api:function(e){return B.match(e,{Add:function(e,n){return Object(l.pipe)(n,m.fold((function(){return o.stater.of(t)}),(function(n){return Object(l.pipe)(ve(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(n,!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{_rev:n.body.rev})),y.bimap(o.cmdr.map((function(t){return Ce.Todo(e._id,t)})),Se(e._id,t)))})))},Change:m.fold((function(){return o.stater.of(t)}),(function(e){var n=e.doc;return"_deleted"in n?o.stater.of(Object(l.pipe)(t,xe.modify(p.deleteAt(n._id)))):Object(l.pipe)(ve(n),y.bimap(o.cmdr.map((function(e){return Ce.Todo(n._id,e)})),Se(n._id,t)))})),Load:m.fold((function(){return o.stater.of(t)}),(function(e){return Object(l.pipe)(e.body.rows.map((function(e){return ve(e.doc)})),b.reduce(o.stater.of({}),(function(e,t){var n=a()(t,2),r=n[0],c=n[1],i=Object(l.pipe)(r,me.get);return ke.ap([p.insertAt(i,r),Object(l.pipe)(c,o.cmdr.map((function(e){return Ce.Todo(i,e)})))],e)})),y.map((function(e){return Object(l.pipe)(t,we.set(g.some(e)))})))})),Remove:function(e,n){return o.stater.of(Object(l.pipe)(n,m.fold((function(){return t}),(function(){return Object(l.pipe)(t,xe.modify(p.deleteAt(e._id)))}))))},default:function(){return o.stater.of(t)}})},Todo:function(e,n){return Object(l.pipe)(t,Ae(e).getOption,g.fold((function(){return o.stater.of(t)}),(function(r){return Object(l.pipe)(function(e,t){return pe.match(t,{Editing:function(n,r){return je.match(e,{Cancel:function(){return o.stater.of(pe.None(n))},Save:function(){return[pe.None(fe({},n,{text:r})),Object(l.pipe)(G(fe({},n,{text:r})),o.cmdr.map(je.Api))]},UpdateText:function(e){return[Object(l.pipe)(t,ge.set(e)),o.cmdr.none]},default:function(){return o.stater.of(t)}})},None:function(n){return je.match(e,{Api:function(e){return B.match(e,{Change:function(e){return Object(l.pipe)(e,g.fromEither,g.filter((function(e){return e.doc._id===n._id})),g.fold((function(){return o.stater.of(t)}),(function(e){var n=e.doc;return o.stater.of(Object(l.pipe)(t,be.set(n._rev)))})))},Update:function(e,r){return o.stater.of(Object(l.pipe)(r,g.fromEither,g.filter((function(e){return e.body.id===n._id})),g.fold((function(){return t}),(function(e){return Object(l.pipe)(t,be.set(e.body.rev))}))))},default:function(){return o.stater.of(t)}})},Edit:function(){return o.stater.of(pe.Editing(n,n.text))},Remove:function(){return[t,Object(l.pipe)(z(n),o.cmdr.map(je.Api))]},ToggleDone:function(){var e=Object(l.pipe)(t,se.modify(Object(ne.not)(ne.identity)));return[e,pe.match(e,{None:function(e){return Object(l.pipe)(G(e),o.cmdr.map(je.Api))},default:function(){return o.cmdr.none}})]},ToggleFav:function(){var e=Object(l.pipe)(t,de.modify(Object(ne.not)(ne.identity)));return[e,pe.match(e,{None:function(e){return Object(l.pipe)(G(e),o.cmdr.map(je.Api))},default:function(){return o.cmdr.none}})]},default:function(){return o.stater.of(t)}})}})}(n,r),y.bimap(o.cmdr.map((function(t){return Ce.Todo(e,t)})),(function(n){return Object(l.pipe)(t,Ae(e).set(n))})))})))},TodoForm:function(e){return Object(l.pipe)(te(e,t.current),y.bimap(o.cmdr.map(Ce.TodoForm),(function(e){return Object(l.pipe)(t,Te.set(e))})))},default:function(){return o.stater.of(t)}})}),(function(e){return function(t){var n=Object(l.pipe)(e.todos,g.map((function(e){return j.fromArray(Ne(p.toArray(e)))}))),r=Object(l.pipe)(n,g.flatten,g.map((function(e){return{done:e.filter((function(e){var t=a()(e,2),n=(t[0],t[1]);return se.get(n)})).length,total:e.length}})));return _.createElement("div",{className:"card"},_.createElement("div",{className:"card-header"},_.createElement("h3",{className:"card-title"},_.createElement(P,{stats:r}))),_.createElement("div",{className:"card-body"},_.createElement((function(){return function(e){return function(t){return _.createElement(H,{value:e.todo.text,onChange:function(e){return t(Z.UpdateText({text:e}))},onSubmit:function(){return t(Z.Add())}})}}(e.current)((function(e){return t(Ce.TodoForm(e))}))}),null)),_.createElement("ul",{className:"list-group list-group-flush"},Object(l.pipe)(n,g.fold((function(){return _.createElement(T,null)}),g.fold((function(){return _.createElement(N,null)}),(function(e){return _.createElement(_.Fragment,null,e.map((function(e){var n=a()(e,2),r=n[0];return function(e){return function(t){return pe.match(e,{Editing:function(e,n){return _.createElement(ue,{key:e._id,text:n,onCancel:function(){return t(je.Cancel())},onChange:function(e){return t(je.UpdateText(e.target.value))},onSave:function(){return t(je.Save())}})},None:function(e){return _.createElement(ie,Object.assign({key:e._id},e,{onEdit:function(){return t(je.Edit())},onRemove:function(){return t(je.Remove())},onToggleDone:function(){return t(je.ToggleDone())},onToggleFav:function(){return t(je.ToggleFav())}}))}})}}(n[1])((function(e){return t(Ce.Todo(r,e))}))})))}))))))}}),Fe),Ue=n(131);o.html.run(Le,(function(e){Ue.render(e,document.getElementById("app"))}),{http:o.http.fetch,seed:Date.now()*Math.random()})}});
//# sourceMappingURL=main.b12962bd021f52f348fe.js.map