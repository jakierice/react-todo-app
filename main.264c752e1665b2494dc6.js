!function(e){function t(t){for(var r,i,u=t[0],a=t[1],f=t[2],l=0,s=[];l<u.length;l++)i=u[l],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&s.push(o[i][0]),o[i]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(p&&p(t);s.length;)s.shift()();return c.push.apply(c,f||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,u=1;u<n.length;u++){var a=n[u];0!==o[a]&&(r=!1)}r&&(c.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={1:0},c=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var u=window.webpackJsonp=window.webpackJsonp||[],a=u.push.bind(u);u.push=t,u=u.slice();for(var f=0;f<u.length;f++)t(u[f]);var p=a;c.push([168,0]),n()}({168:function(e,t,n){"use strict";n.r(t);var r,o=n(87),c=n.n(o),i=n(73),u=n.n(i),a=n(41),f=n(46),p=n(3),l=n(119),s=n(70),d=n(17),m=n(52),b=n(8),O=n(12),g=n(7),j=n(120),v=n(16),h=n(67),y=n(47),E=n(6),_=function(e){var t=e.stats;return E.createElement(E.Fragment,null,"Simple TodoÂ ",Object(p.pipe)(t,g.fold((function(){return null}),(function(e){var t=e.done,n=e.total;return E.createElement("span",{className:"text-muted small"},t," / ",n)}))))},P=function(){return E.createElement("li",{className:"list-group-item"},E.createElement("em",null,"Task list is empty."))},N=function(){return E.createElement("li",{className:"list-group-item"},E.createElement("em",null,"Loading Tasks..."))},w=n(31),T=n(10),x=n(115),A=n(11),C=n(77),D=n(20),S=n(19),k=n(116),F=n(51),L=n(100),U=n(84),R=T.interface({_id:T.string,text:T.string,isDone:T.boolean,isFav:Object(x.withFallback)(T.boolean,!1)},"Todo"),M=function(e){return T.intersection([T.interface({_rev:T.string}),e])},I=T.interface({ok:T.boolean,id:T.string,rev:T.string},"Response"),q=Object(O.Union)({Add:Object(O.of)(),Change:Object(O.of)(),Load:Object(O.of)(),Remove:Object(O.of)(),Update:Object(O.of)()}),B=b.http.send(b.http.get("/todos/_all_docs?include_docs=true",(r=R,T.interface({total_rows:T.Int,offset:T.Int,rows:T.array(T.interface({id:T.string,key:T.string,doc:M(r),value:T.interface({rev:T.string})}))},"AllDocsResponse"))),q.Load),J=function(e){return b.http.send(b.http.del("/todos/".concat(e._id,"?_rev=").concat(e._rev),I),(function(t){return q.Remove(e,t)}))},W=function(e){return b.http.send(b.http.put("/todos/".concat(e._id,"?rev=").concat(e._rev),M(R).encode(e),I),(function(t){return q.Update(e,t)}))},z=new A.a,G=new C.a("now"),H=new C.a(!1),K=Object(p.pipe)(Object(k.fromFetch)("/todos/_changes?feed=longpoll&include_docs=true&since=".concat(G.value)),F.a((function(e){return Object(D.a)(e.json())})),L.a((function(e){e.results.forEach((function(e){return z.next(q.Change(function(e){return T.interface({changes:T.array(T.interface({rev:T.string})),doc:T.union([T.interface({_id:T.string,_rev:T.string,_deleted:T.literal(!0)}),M(e)]),id:T.string,seq:T.Int})}(R).decode(e)))})),G.next(e.last_seq)})),F.a((function(){return K})));Object(p.pipe)(H,U.a(),F.a((function(e){return e?K:Object(S.b)()}))).subscribe();var Q=function(){return H.next(!0),z},V=function(){return H.next(!1),Object(S.b)()},X=function(e){var t=e.value,n=e.onChange,r=e.onSubmit;return E.createElement("form",{onSubmit:function(e){r(),e.preventDefault()}},E.createElement("div",{className:"input-group"},E.createElement("input",{type:"text",className:"form-control",name:"task",value:t,onChange:function(e){return n(e.target.value)}}),E.createElement("div",{className:"input-group-append"},E.createElement("button",{type:"submit",className:"btn btn-primary",disabled:""===t},"Add"))))},Y=function(e){return 16807*e%2147483647},Z=n(117),$=n.n(Z),ee=w.a.fromProp()("seed"),te=w.a.fromProp()("todo"),ne=te.composeLens(w.a.fromProp()("text")),re=Object(O.Union)({Add:Object(O.of)(),Api:Object(O.of)(),UpdateText:Object(O.of)()}),oe=function(e){return{_id:$.a.v1({msecs:e}),text:"",isDone:!1,isFav:!1}},ce=n(21),ie=n(48),ue=n(49),ae=n(99),fe=function(e){var t=e.isFav,n=e.isDone,r=e.text,o=e.onEdit,c=e.onToggleFav,i=e.onToggleDone,u=e.onRemove;return E.createElement("li",{className:"task-container list-group-item d-flex justify-content-between align-items-center"},E.createElement("div",null,E.createElement("a",{href:"#",className:"btn-left",onClick:c},E.createElement(ie.a,{icon:t?ue.d:ae.b})),E.createElement("a",{href:"#",className:"btn-left",onClick:i},E.createElement(ie.a,{icon:n?ue.a:ae.a})),n?E.createElement("del",{className:"text-muted"},r):r),E.createElement("div",null,E.createElement("a",{href:"#",className:"btn-right",onClick:o},E.createElement(ie.a,{icon:ue.b})),E.createElement("a",{href:"#",className:"btn-right",onClick:u},E.createElement(ie.a,{icon:ue.e}))))},pe=function(e){var t=e.text,n=e.onChange,r=e.onSave,o=e.onCancel;return E.createElement("li",{className:"task-container list-group-item"},E.createElement("form",{onSubmit:function(e){r(),e.preventDefault()}},E.createElement("div",{className:"input-group"},E.createElement("input",{className:"form-control",type:"text",value:t,onChange:n}),E.createElement("div",{className:"input-group-append"},E.createElement("button",{className:"btn btn-success",type:"submit"},E.createElement(ie.a,{icon:ue.c})),E.createElement("button",{className:"btn btn-danger",type:"button",onClick:o},E.createElement(ie.a,{icon:ue.e}))))))};function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(n,!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de=Object(O.Union)({Editing:Object(O.of)(),None:Object(O.of)()}),me=new w.a((function(e){return de.match(e,{Editing:function(e){return e},None:function(e){return e}})}),(function(e){return function(t){return de.match(t,{Editing:function(t,n){return de.Editing(e,n)},None:function(){return de.None(e)}})}})),be=me.composeLens(w.a.fromProp()("isDone")),Oe=me.composeLens(w.a.fromProp()("isFav")),ge=me.composeLens(w.a.fromProp()("_id")),je=me.composeLens(w.a.fromProp()("_rev")),ve=me.composeLens(w.a.fromProp()("text")),he=new w.b((function(e){return de.match(e,{Editing:function(e,t){return g.some(t)},default:function(){return g.none}})}),(function(e){return function(t){return de.match(t,{Editing:function(t){return de.Editing(t,e)},default:function(){return t}})}})),ye=Object(O.Union)({Api:Object(O.of)(),Cancel:Object(O.of)(),Edit:Object(O.of)(),Save:Object(O.of)(),ToggleDone:Object(O.of)(),ToggleFav:Object(O.of)(),Remove:Object(O.of)(),UpdateText:Object(O.of)()}),Ee=function(e){return b.state.of(de.None(e))},_e=n(118);function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ne=Object(a.contramap)((function(e){return e.toLocaleLowerCase()}))(a.ordString),we=Object(a.contramap)(ve.get)(Ne),Te=Object(a.contramap)(be.get)(a.ordBoolean),xe=Object(a.getSemigroup)().concat(Te,we),Ae=m.sort(Object(a.contramap)((function(e){var t=u()(e,2);t[0];return t[1]}))(xe)),Ce=s.Lens.fromProp()("current"),De=s.Lens.fromProp()("todos"),Se=De.composePrism(s.Prism.some()),ke=function(e){return Se.composeLens(Object(l.atRecord)().at(e)).composePrism(s.Prism.some())},Fe=function(e,t){return function(n){return Object(p.pipe)(t,Se.modify(f.insertAt(e,n)))}},Le=Object(O.Union)({Api:Object(O.of)(),Todo:Object(O.of)(),TodoForm:Object(O.of)()}),Ue=b.cmd.getMonoid(),Re=b.state.getApplicative(),Me=b.html.programWithFlags((function(e){return Object(p.pipe)((t=e.seed,[{seed:n=function(e){var t=e%2147483647;return t<=0?t+2147483646:t}(t),todo:oe(n)},b.cmd.none]),y.bimap((function(e){return Object(h.fold)(Ue)([Object(p.pipe)(e,b.cmd.map(Le.TodoForm)),Object(p.pipe)(B,b.cmd.map(Le.Api))])}),(function(e){return{current:e,todos:g.none}})));var t,n}),(function(e,t){return Le.match(e,{Api:function(e){return q.match(e,{Add:function(e,n){return Object(p.pipe)(n,d.fold((function(){return b.state.of(t)}),(function(n){return Object(p.pipe)(Ee(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(n,!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{_rev:n.body.rev})),y.bimap(b.cmd.map((function(t){return Le.Todo(e._id,t)})),Fe(e._id,t)))})))},Change:d.fold((function(){return b.state.of(t)}),(function(e){var n=e.doc;return"_deleted"in n?b.state.of(Object(p.pipe)(t,Se.modify(f.deleteAt(n._id)))):Object(p.pipe)(Ee(n),y.bimap(b.cmd.map((function(e){return Le.Todo(n._id,e)})),Fe(n._id,t)))})),Load:d.fold((function(){return b.state.of(t)}),(function(e){return Object(p.pipe)(e.body.rows.map((function(e){return Ee(e.doc)})),m.reduce(b.state.of({}),(function(e,t){var n=u()(t,2),r=n[0],o=n[1],c=Object(p.pipe)(r,ge.get);return Re.ap([f.insertAt(c,r),Object(p.pipe)(o,b.cmd.map((function(e){return Le.Todo(c,e)})))],e)})),y.map((function(e){return Object(p.pipe)(t,De.set(g.some(e)))})))})),Remove:function(e,n){return b.state.of(Object(p.pipe)(n,d.fold((function(){return t}),(function(){return Object(p.pipe)(t,Se.modify(f.deleteAt(e._id)))}))))},default:function(){return b.state.of(t)}})},Todo:function(e,n){return Object(p.pipe)(t,ke(e).getOption,g.fold((function(){return b.state.of(t)}),(function(r){return Object(p.pipe)(function(e,t){return de.match(t,{Editing:function(n,r){return ye.match(e,{Cancel:function(){return b.state.of(de.None(n))},Save:function(){return[de.None(se({},n,{text:r})),Object(p.pipe)(W(se({},n,{text:r})),b.cmd.map(ye.Api))]},UpdateText:function(e){return[Object(p.pipe)(t,he.set(e)),b.cmd.none]},default:function(){return b.state.of(t)}})},None:function(n){return ye.match(e,{Api:function(e){return q.match(e,{Change:function(e){return Object(p.pipe)(e,g.fromEither,g.filter((function(e){return e.doc._id===n._id})),g.fold((function(){return b.state.of(t)}),(function(e){var n=e.doc;return b.state.of(Object(p.pipe)(t,je.set(n._rev)))})))},Update:function(e,r){return b.state.of(Object(p.pipe)(r,g.fromEither,g.filter((function(e){return e.body.id===n._id})),g.fold((function(){return t}),(function(e){return Object(p.pipe)(t,je.set(e.body.rev))}))))},default:function(){return b.state.of(t)}})},Edit:function(){return b.state.of(de.Editing(n,n.text))},Remove:function(){return[t,Object(p.pipe)(J(n),b.cmd.map(ye.Api))]},ToggleDone:function(){var e=Object(p.pipe)(t,be.modify(Object(ce.not)(ce.identity)));return[e,de.match(e,{None:function(e){return Object(p.pipe)(W(e),b.cmd.map(ye.Api))},default:function(){return b.cmd.none}})]},ToggleFav:function(){var e=Object(p.pipe)(t,Oe.modify(Object(ce.not)(ce.identity)));return[e,de.match(e,{None:function(e){return Object(p.pipe)(W(e),b.cmd.map(ye.Api))},default:function(){return b.cmd.none}})]},default:function(){return b.state.of(t)}})}})}(n,r),y.bimap(b.cmd.map((function(t){return Le.Todo(e,t)})),(function(n){return Object(p.pipe)(t,ke(e).set(n))})))})))},TodoForm:function(e){return Object(p.pipe)(function(e,t){return re.match(e,{Add:function(){return[Object(p.pipe)(t,ee.modify(Y),te.set(oe(t.seed))),Object(p.pipe)((e=t.todo,b.http.send(b.http.put("/todos/".concat(e._id),R.encode(e),I),(function(t){return q.Add(e,t)}))),b.cmd.map(re.Api))];var e},UpdateText:function(e){var n=e.text;return[Object(p.pipe)(t,ne.set(n)),b.cmd.none]},default:function(){return[t,b.cmd.none]}})}(e,t.current),y.bimap(b.cmd.map(Le.TodoForm),(function(e){return Object(p.pipe)(t,Ce.set(e))})))},default:function(){return b.state.of(t)}})}),(function(e){var t=Object(p.pipe)(e.todos,g.map((function(e){return j.fromArray(Ae(f.toArray(e)))}))),n=Object(p.pipe)(t,g.flatten,g.map((function(e){return{done:e.filter((function(e){var t=u()(e,2),n=(t[0],t[1]);return be.get(n)})).length,total:e.length}})));return function(r){return E.createElement("div",{className:"card"},E.createElement("div",{className:"card-header"},E.createElement("h3",{className:"card-title"},E.createElement(_,{stats:n}))),E.createElement("div",{className:"card-body"},function(e){return function(t){return E.createElement(X,{value:e.todo.text,onChange:function(e){return t(re.UpdateText({text:e}))},onSubmit:function(){return t(re.Add())}})}}(e.current)((function(e){return r(Le.TodoForm(e))}))),E.createElement("ul",{className:"list-group list-group-flush"},Object(p.pipe)(t,g.fold((function(){return E.createElement(N,null)}),g.fold((function(){return E.createElement(P,null)}),(function(e){return E.createElement(E.Fragment,null,e.map((function(e){var t=u()(e,2),n=t[0];return function(e){return function(t){return de.match(e,{Editing:function(e,n){return E.createElement(pe,{key:e._id,text:n,onCancel:function(){return t(ye.Cancel())},onChange:function(e){return t(ye.UpdateText(e.target.value))},onSave:function(){return t(ye.Save())}})},None:function(e){return E.createElement(fe,Object.assign({key:e._id},e,{onEdit:function(){return t(ye.Edit())},onRemove:function(){return t(ye.Remove())},onToggleDone:function(){return t(ye.ToggleDone())},onToggleFav:function(){return t(ye.ToggleFav())}}))}})}}(t[1])((function(e){return r(Le.Todo(n,e))}))})))}))))))}}),(function(e){return Object(p.pipe)(e.todos,g.fold(V,Q),v.a(Le.Api))}));b.html.run(Me({seed:Date.now()*Math.random()}),(function(e){_e.render(e,document.getElementById("app"))}))}});
//# sourceMappingURL=main.264c752e1665b2494dc6.js.map