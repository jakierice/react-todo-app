!function(e){function t(t){for(var r,i,a=t[0],u=t[1],s=t[2],d=0,p=[];d<a.length;d++)i=a[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(t);p.length;)p.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,a=1;a<n.length;a++){var u=n[a];0!==o[u]&&(r=!1)}r&&(c.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={1:0},c=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var a=window.webpackJsonp=window.webpackJsonp||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var l=u;c.push([161,0]),n()}({161:function(e,t,n){"use strict";n.r(t);var r,o=n(110),c=n.n(o),i=n(46),a=n(34),u=n(5),s=n(116),l=n(35),d=n(15),p=n(82),f=n(63),m=n(12),b=n(22),g=n(7),v=n(117),O=n(16),j=function(e){return 16807*e%2147483647},h=n(6),y=function(e){var t=e.stats;return h.createElement(h.Fragment,null,"Simple TodoÂ ",Object(u.pipe)(t,g.fold((function(){return null}),(function(e){var t=e.done,n=e.total;return h.createElement("span",{className:"text-muted small"},t," / ",n)}))))},E=function(e){var t=e.isEditing,n=e.value,r=e.onChange,o=e.onSubmit;return h.createElement("div",{className:"input-group"},h.createElement("input",{type:"text",className:"form-control",name:"task",value:n,onChange:function(e){return r(e.target.value)}}),h.createElement("div",{className:"input-group-append"},h.createElement("button",{type:"submit",className:"btn btn-primary",onClick:o,disabled:""===n},t?"Edit":"Add")))},_=function(){return h.createElement("li",{className:"list-group-item"},h.createElement("em",null,"Task list is empty."))},w=function(){return h.createElement("li",{className:"list-group-item"},h.createElement("em",null,"Loading Tasks..."))},x=n(67),P=n(68),A=n(93),T=function(e){var t=e.isFav,n=e.isDone,r=e.text,o=e.onEdit,c=e.onToggleFav,i=e.onToggleDone,a=e.onRemove;return h.createElement("li",{className:"task-container list-group-item d-flex justify-content-between align-items-center"},h.createElement("div",null,h.createElement("a",{href:"#",className:"btn-left",onClick:c},h.createElement(x.a,{icon:t?P.c:A.b})),h.createElement("a",{href:"#",className:"btn-left",onClick:i},h.createElement(x.a,{icon:n?P.a:A.a})),n?h.createElement("del",{className:"text-muted"},r):r),h.createElement("div",null,h.createElement("a",{href:"#",className:"btn-right",onClick:o},h.createElement(x.a,{icon:P.b})),h.createElement("a",{href:"#",className:"btn-right",onClick:a},h.createElement(x.a,{icon:P.d}))))},D=n(9),N=n(111),F=n(10),k=n(74),S=n(19),C=n(18),R=n(112),L=n(48),M=n(96),U=n(81),I=D.interface({_id:D.string,text:D.string,isDone:D.boolean,isFav:Object(N.withFallback)(D.boolean,!1)},"Todo"),q=function(e){return D.intersection([D.interface({_rev:D.string}),e])},B=D.interface({ok:D.boolean,id:D.string,rev:D.string},"Response"),J=Object(b.a)({Add:Object(b.b)(),Change:Object(b.b)(),Load:Object(b.b)(),Remove:Object(b.b)(),Update:Object(b.b)()}),W=m.http.send(m.http.get("/todos/_all_docs?include_docs=true",(r=I,D.interface({total_rows:D.Int,offset:D.Int,rows:D.array(D.interface({id:D.string,key:D.string,doc:q(r),value:D.interface({rev:D.string})}))},"AllDocsResponse"))),J.Load),z=function(e){return m.http.send(m.http.del("/todos/".concat(e._id,"?_rev=").concat(e._rev),B),(function(t){return J.Remove({todo:e,response:t})}))},G=function(e){return m.http.send(m.http.put("/todos/".concat(e._id,"?rev=").concat(e._rev),q(I).encode(e),B),(function(t){return J.Update({todo:e,response:t})}))},H=new F.a,K=new k.a("now"),Q=new k.a(!1),V=Object(u.pipe)(Object(R.fromFetch)("/todos/_changes?feed=longpoll&include_docs=true&since=".concat(K.value)),L.a((function(e){return Object(S.a)(e.json())})),M.a((function(e){e.results.forEach((function(e){return H.next(J.Change(function(e){return D.interface({changes:D.array(D.interface({rev:D.string})),doc:D.union([D.interface({_id:D.string,_rev:D.string,_deleted:D.literal(!0)}),q(e)]),id:D.string,seq:D.Int})}(I).decode(e)))})),K.next(e.last_seq)})),L.a((function(){return V})));Object(u.pipe)(Q,U.a(),L.a((function(e){return e?V:Object(C.b)()}))).subscribe();var X=function(){return Q.next(!0),H},Y=function(){return Q.next(!1),Object(C.b)()},Z=n(113),$=n.n(Z),ee=n(114);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=function(e){return{_id:$.a.v1({msecs:e}),text:"",isDone:!1,isFav:!1}},oe=Object(i.contramap)((function(e){return e.text}))(i.ordString),ce=Object(i.contramap)((function(e){return e.isDone}))(i.ordBoolean),ie=Object(i.getSemigroup)().concat(ce,oe),ae=f.sort(ie),ue=a.fromFoldableMap(Object(p.getFirstSemigroup)(),f.array),se=l.b.fromProp()("current"),le=se.composeLens(l.b.fromProp()("text")),de=l.b.fromProp()("seed"),pe=l.b.fromProp()("todos"),fe=pe.composePrism(l.c.some()),me=function(e){return fe.composeLens(Object(s.a)().at(String(e))).composePrism(l.c.some())},be=Object(b.a)({Api:Object(b.b)(),Add:Object(b.b)(),Edit:Object(b.b)(),ToggleDone:Object(b.b)(),ToggleFav:Object(b.b)(),Remove:Object(b.b)(),UpdateText:Object(b.b)()}),ge=m.html.programWithFlags((function(e){var t=function(e){var t=e%2147483647;return t<=0?t+2147483646:t}(e.seed);return[{seed:j(t),current:re(t),todos:g.none},Object(u.pipe)(W,m.cmd.map(be.Api))]}),(function(e,t){return be.match(e,{Api:function(e){return J.match(e,{Add:function(e){var n=e.todo,r=e.response;return Object(u.pipe)(r,d.fold((function(){return[t,m.cmd.none]}),(function(e){return[Object(u.pipe)(t,de.modify(j),se.set(re(t.seed)),fe.modify(a.insertAt(e.body.id,ne({},n,{_rev:e.body.rev})))),m.cmd.none]})))},Change:d.fold((function(){return[t,m.cmd.none]}),(function(e){var n=e.doc;return[Object(u.pipe)(t,fe.modify("_deleted"in n?a.deleteAt(n._id):a.insertAt(n._id,n))),m.cmd.none]})),Load:d.fold((function(){return[t,m.cmd.none]}),(function(e){var n=e.body.rows.map((function(e){return e.doc})),r=ue(n,(function(e){return[e._id,e]}));return[Object(u.pipe)(t,pe.set(g.some(r))),m.cmd.none]})),Remove:function(e){var n=e.todo,r=e.response;return Object(u.pipe)(r,d.fold((function(){return[t,m.cmd.none]}),(function(){return[Object(u.pipe)(t,fe.modify(a.deleteAt(n._id))),m.cmd.none]})))},Update:function(e){var n=e.todo,r=e.response;return Object(u.pipe)(r,d.fold((function(){return[t,m.cmd.none]}),(function(e){return[Object(u.pipe)(t,(r=n._id,me(r).composeLens(l.b.fromProp()("_rev"))).set(e.body.rev)),m.cmd.none];var r})))}})},Add:function(){return[Object(u.pipe)(t,de.modify(j),se.set(re(t.seed))),Object(u.pipe)((e=t.current,m.http.send(m.http.put("/todos/".concat(e._id),I.encode(e),B),(function(t){return J.Add({todo:e,response:t})}))),m.cmd.map(be.Api))];var e},Edit:function(e){var n=e.todo;return[Object(u.pipe)(t,se.set(n)),m.cmd.none]},ToggleDone:function(e){var n=e.todo,r=ne({},n,{isDone:!n.isDone});return[Object(u.pipe)(t,me(n._id).set(r)),Object(u.pipe)(G(r),m.cmd.map(be.Api))]},ToggleFav:function(e){var n=e.todo,r=ne({},n,{isFav:!n.isFav});return[Object(u.pipe)(t,me(n._id).set(r)),Object(u.pipe)(G(r),m.cmd.map(be.Api))]},Remove:function(e){var n=e.todo;return[t,Object(u.pipe)(z(n),m.cmd.map(be.Api))]},UpdateText:function(e){var n=e.text;return[Object(u.pipe)(t,le.set(n)),m.cmd.none]},default:function(){return[t,m.cmd.none]}})}),(function(e){var t=Object(u.pipe)(e.todos,g.map((function(e){return v.fromArray(ae(Object.values(e)))}))),n=Object(u.pipe)(t,g.flatten,g.map((function(e){return{done:e.filter((function(e){return e.isDone})).length,total:e.length}}))),r="_rev"in e.current;return function(o){return h.createElement("div",{className:"card"},h.createElement("div",{className:"card-header"},h.createElement("h3",{className:"card-title"},h.createElement(y,{stats:n}))),h.createElement("div",{className:"card-body"},h.createElement(E,{isEditing:r,value:e.current.text,onChange:function(e){return o(be.UpdateText({text:e}))},onSubmit:function(){return o(be.Add())}})),h.createElement("ul",{className:"list-group list-group-flush"},Object(u.pipe)(t,g.fold((function(){return h.createElement(w,null)}),g.fold((function(){return h.createElement(_,null)}),(function(e){return h.createElement(h.Fragment,null,e.map((function(e){return h.createElement(T,Object.assign({key:e._id},e,{onEdit:function(){return o(be.Edit({todo:e}))},onRemove:function(){return o(be.Remove({todo:e}))},onToggleDone:function(){return o(be.ToggleDone({todo:e}))},onToggleFav:function(){return o(be.ToggleFav({todo:e}))}}))})))}))))))}}),(function(e){return Object(u.pipe)(e.todos,g.fold(Y,X),O.a(be.Api))}));m.html.run(ge({seed:Date.now()*Math.random()}),(function(e){ee.render(e,document.getElementById("app"))}))}});
//# sourceMappingURL=main.7ee879bb4bb2af418f76.js.map